import{E as e,n as t,r as o,o as s,c as a,b as n,w as l,a as i,p as r,q as u,v as d,F as c}from"./vendor.b9b631e1.js";const m={data:()=>({Name:"",CName:"",Password:"",CPassword:"",createShow:!1}),methods:{loginError(){e.alert("账号或密码错误！","登陆错误",{confirmButtonText:"OK",callback:e=>{t({type:"info",message:"登录失败"})}})},createshow(){this.createShow=!this.createShow},onSubmit_signup(){this.createShow=!1;const e={Name:this.CName,Password:this.CPassword};fetch("http://localhost:8080/user/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{const t=e.success;this.$store.commit("setUser",this.Name),this.$store.commit("setAuthentication",!0),window.sessionStorage.setItem("token",t),this.$router.push("/")})).catch((e=>{console.error("Login failed",e)}))},onSubmit(){const e={Name:this.Name,Password:this.Password};fetch("http://localhost:8080/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(401===e.status)throw this.loginError(),new Error("Unauthorized");return e.json()})).then((e=>{const t=e.success;this.$store.commit("setUser",this.Name),this.$store.commit("setAuthentication",!0),window.sessionStorage.setItem("token",t),this.$router.push("/")})).catch((e=>{console.error("Login failed",e)}))}}},h=i("input",{type:"submit",id:"submit",value:"注册"},null,-1),p={class:"content"},w={class:"login"},S=i("div",{class:"topHead"},[i("h2",null,"Welcome!"),i("h3",null,"Sign in to Use")],-1),f={class:"info"},b=i("input",{type:"submit",id:"submit",value:"login"},null,-1);m.render=function(e,t,m,g,y,N){const P=o("el-input"),v=o("el-form-item"),C=o("el-form"),U=o("el-dialog");return s(),a(c,null,[n(U,{modelValue:y.createShow,"onUpdate:modelValue":t[3]||(t[3]=e=>y.createShow=e),title:"注册",width:"30%"},{default:l((()=>[n(C,{action:"",onSubmit:r(N.onSubmit_signup,["prevent"])},{default:l((()=>[n(v,{label:"用户名"},{default:l((()=>[n(P,{type:"text",placeholder:"   Username",modelValue:y.CName,"onUpdate:modelValue":t[0]||(t[0]=e=>y.CName=e)},null,8,["modelValue"])])),_:1}),n(v,{label:"密码"},{default:l((()=>[n(P,{type:"password",placeholder:"   Password",modelValue:y.CPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>y.CPassword=e)},null,8,["modelValue"])])),_:1}),i("a",{onClick:t[2]||(t[2]=e=>y.createShow=!1),style:{color:"#aac0ca",cursor:"pointer"}},"已有账号？现在登录！"),h])),_:1},8,["onSubmit"])])),_:1},8,["modelValue"]),i("view",p,[i("div",w,[S,i("div",f,[i("form",{action:"http://localhost:8080/login",onSubmit:t[7]||(t[7]=r(((...e)=>N.onSubmit&&N.onSubmit(...e)),["prevent"])),ref:"loginForm"},[i("div",null,[u(i("input",{type:"text",placeholder:"   Username","onUpdate:modelValue":t[4]||(t[4]=e=>y.Name=e)},null,512),[[d,y.Name]])]),i("div",null,[u(i("input",{type:"password",placeholder:"   Password","onUpdate:modelValue":t[5]||(t[5]=e=>y.Password=e)},null,512),[[d,y.Password]])]),i("a",{onClick:t[6]||(t[6]=(...e)=>N.createshow&&N.createshow(...e))},"没有账号？现在注册！"),b],544)])])])],64)};export{m as default};
